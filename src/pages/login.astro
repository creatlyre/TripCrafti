---
import Logo from '../components/ui/Logo.astro';
import Layout from '../layouts/Layout.astro';
export const prerender = false;
import Auth from '../components/auth/Auth.tsx';
import { getDictionary } from '../lib/i18n';

const lang = Astro.locals.lang;
const dict = getDictionary(lang);

function switchUrl(target: string) {
  const url = new URL(Astro.request.url);
  url.searchParams.set('lang', target);
  return url.pathname + '?' + url.searchParams.toString();
}
---

<Layout title={`${dict.login.heading} â€“ TripCrafti`}>
  <main class="min-h-screen bg-slate-950 text-slate-50 flex flex-col">
    <header class="flex items-center justify-between px-6 py-5">
      <Logo size="md" href={switchUrl(lang)} />
      <nav aria-label="Secondary" class="flex items-center gap-2">
        <div class="flex items-center gap-1" aria-label={dict.langSwitcher.label}>
          <a
            href={switchUrl('pl')}
            lang="pl"
            hreflang="pl"
            class={`inline-flex items-center gap-1.5 rounded-md px-2.5 py-1 text-[11px] font-medium border transition ${lang === 'pl' ? 'border-indigo-400/60 text-white bg-slate-800/60' : 'border-slate-700/70 text-slate-300 hover:text-white hover:border-indigo-400/50'}`}
            >ðŸ‡µðŸ‡± <span class="hidden sm:inline">PL</span></a
          >
          <a
            href={switchUrl('en')}
            lang="en"
            hreflang="en"
            class={`inline-flex items-center gap-1.5 rounded-md px-2.5 py-1 text-[11px] font-medium border transition ${lang === 'en' ? 'border-indigo-400/60 text-white bg-slate-800/60' : 'border-slate-700/70 text-slate-300 hover:text-white hover:border-indigo-400/50'}`}
            >ðŸ‡¬ðŸ‡§ <span class="hidden sm:inline">EN</span></a
          >
        </div>
        <a
          href={switchUrl(lang === 'pl' ? 'pl' : 'en')}
          class="text-xs font-medium text-slate-400 hover:text-slate-200 transition">{dict.navigation?.home}</a
        >
      </nav>
    </header>

    <div class="flex flex-1 items-center justify-center px-6 pb-24">
      <div class="w-full max-w-md rounded-2xl border border-slate-800 bg-slate-900/70 p-8 shadow-lg backdrop-blur">
        <h1 class="text-xl font-semibold tracking-tight">{dict.login.heading}</h1>
        <p class="mt-2 text-sm text-slate-400 leading-relaxed">{dict.login.sub}</p>
        <div class="mt-8">
          <Auth client:load />
        </div>
      </div>
    </div>
    <footer class="px-6 py-8 text-center text-xs text-slate-500/80"><p>{dict.footer.copyright}</p></footer>
  </main>
</Layout>
